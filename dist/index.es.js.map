{"mappings":"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","sources":["src/index.ts","src/core/middlewares/auth/verifyToken.ts","src/modules/auth/auth-repository.ts","src/core/config/env/index.ts","src/core/helpers/error.ts","src/core/helpers/response.ts","src/modules/auth/auth-module.ts","src/modules/auth/auth-router.ts","src/modules/auth/auth-controller.ts","src/modules/auth/auth-service.ts","src/core/providers/nodemailer.ts"],"sourcesContent":["'use strict'\r\nimport fs from 'fs'\r\nimport express, { Application, Router } from 'express'\r\nimport { Module } from './modules/module-interface'\r\nimport cors from 'cors'\r\nimport { verifyToken } from './core/middlewares/auth/verifyToken'\r\nimport { Config } from './core/config/env'\r\nimport AuthModule from './modules/auth/auth-module'\r\nimport morgan from 'morgan'\r\n\r\nexport { onSuccess, onError } from './core/helpers/response'\r\nexport * from './core/helpers/error'\r\nexport interface Bootstrap {\r\n  modules: Array<Module>\r\n  context: string\r\n  version: string\r\n}\r\nexport class PullupModules implements Bootstrap {\r\n  public modules: Array<Module> = [new AuthModule('auth')]\r\n  public context: string\r\n  public version: string\r\n  private _env: Config\r\n\r\n  constructor(modules: Array<Module>) {\r\n    this._env = Config.instance\r\n    this.modules = this.modules.concat(modules)\r\n    this.context = this._env.config.apiContext || 'api'\r\n    this.version = this._env.config.apiVersion || 'v1'\r\n  }\r\n\r\n  public bootstrap() {\r\n    const router: Router = Router()\r\n    const app: Application = express()\r\n\r\n    app.disable('x-powered-by')\r\n    app.use(morgan('dev'))\r\n    app.use(\r\n      cors({\r\n        allowedHeaders: [\r\n          'Origin',\r\n          'X-Requested-With',\r\n          'Content-Type',\r\n          'queue-token',\r\n          'Accept',\r\n          'X-Access-Token',\r\n          'Authorization',\r\n        ],\r\n        credentials: true,\r\n        methods: 'GET,HEAD,OPTIONS,PUT,PATCH,POST,DELETE',\r\n        origin: '*',\r\n        preflightContinue: false,\r\n      })\r\n    )\r\n    app.use(express.json({ limit: '5mb' }))\r\n    app.use(express.urlencoded({ extended: true }))\r\n\r\n    this.modules.forEach((module) => {\r\n      router.use(\r\n        `/${this.context}/${this.version}/${module.moduleName}`,\r\n        -!module.isPublic ? verifyToken : (_, __, next) => next(),\r\n        module.router.router\r\n      )\r\n    })\r\n    app.use(router)\r\n\r\n    app\r\n      .listen(this._env.config.serverPort, () => {\r\n        console.log(\r\n          `Server up and running on port: ${this._env.config.serverPort} `\r\n        )\r\n      })\r\n      .on('error', (error) => console.error(`Error: ${error}`))\r\n\r\n    return app\r\n  }\r\n}\r\n\r\nexport class StartModules {\r\n  modules: Array<string>\r\n  folderName: string = 'unknow'\r\n  constructor(modules: Array<string>, folderName: string = 'unknowContext') {\r\n    this.folderName = folderName\r\n    this.modules = modules\r\n  }\r\n\r\n  async createModules(srcDirName: string) {\r\n    const moduleFiles: string[] = []\r\n    let files: any\r\n    if (!fs.existsSync(`${srcDirName}/modules`)) {\r\n      fs.mkdirSync(`${srcDirName}/modules`, { recursive: true })\r\n    }\r\n\r\n    files = fs.readdirSync(`${srcDirName}/modules`)\r\n\r\n    this.modules.forEach((module) => {\r\n      let isOk = true\r\n      for (const file in files) {\r\n        if (file === module) {\r\n          isOk = false\r\n        }\r\n      }\r\n      if (isOk) {\r\n        moduleFiles.push(module)\r\n      }\r\n    })\r\n\r\n    moduleFiles.forEach((moduleFile) => {\r\n      let modelName = moduleFile.charAt(0).toUpperCase() + moduleFile.slice(1)\r\n      if (!fs.existsSync(`${srcDirName}/modules/${moduleFile}`)) {\r\n        fs.mkdir(\r\n          `${srcDirName}/modules/${moduleFile}`,\r\n          { recursive: true },\r\n          (err) => {\r\n            if (err) console.error(err)\r\n          }\r\n        )\r\n      }\r\n\r\n      if (\r\n        fs.existsSync(\r\n          srcDirName +\r\n            '/node_modules/@pullup.tech/cms/samples/controller-sample.txt'\r\n        )\r\n      ) {\r\n        let controller = fs.readFileSync(\r\n          srcDirName +\r\n            '/node_modules/@pullup.tech/cms/samples/controller-sample.txt'\r\n        )\r\n        const controllerCode = Buffer.from(controller)\r\n          .toString()\r\n          .replace(/{{MODULE_NAME}}/g, moduleFile)\r\n          .replace(/{{MODEL_NAME}}/g, modelName)\r\n        fs.writeFile(\r\n          `${srcDirName}/modules/${moduleFile}/${moduleFile}-controller.ts`,\r\n          controllerCode,\r\n          (err) => {\r\n            if (err) console.error(err)\r\n            else {\r\n              console.log('Controller File written successfully\\n')\r\n            }\r\n          }\r\n        )\r\n      } else {\r\n        console.log('Controller File not written\\n')\r\n      }\r\n\r\n      if (\r\n        fs.existsSync(\r\n          srcDirName +\r\n            '/node_modules/@pullup.tech/cms/samples/router-sample.txt'\r\n        )\r\n      ) {\r\n        let controller = fs.readFileSync(\r\n          srcDirName +\r\n            '/node_modules/@pullup.tech/cms/samples/router-sample.txt'\r\n        )\r\n        const controllerCode = Buffer.from(controller)\r\n          .toString()\r\n          .replace(/{{MODULE_NAME}}/g, moduleFile)\r\n          .replace(/{{MODEL_NAME}}/g, modelName)\r\n        fs.writeFile(\r\n          `${srcDirName}/modules/${moduleFile}/${moduleFile}-router.ts`,\r\n          controllerCode,\r\n          (err) => {\r\n            if (err) console.error(err)\r\n            else {\r\n              console.log('Router File written successfully\\n')\r\n            }\r\n          }\r\n        )\r\n      } else {\r\n        console.log('Router File not written\\n')\r\n      }\r\n\r\n      if (\r\n        fs.existsSync(\r\n          srcDirName +\r\n            '/node_modules/@pullup.tech/cms/samples/service-sample.txt'\r\n        )\r\n      ) {\r\n        let controller = fs.readFileSync(\r\n          srcDirName +\r\n            '/node_modules/@pullup.tech/cms/samples/service-sample.txt'\r\n        )\r\n        const controllerCode = Buffer.from(controller)\r\n          .toString()\r\n          .replace(/{{MODULE_NAME}}/g, moduleFile)\r\n          .replace(/{{MODEL_NAME}}/g, modelName)\r\n        fs.writeFile(\r\n          `${srcDirName}/modules/${moduleFile}/${moduleFile}-service.ts`,\r\n          controllerCode,\r\n          (err) => {\r\n            if (err) console.error(err)\r\n            else {\r\n              console.log('Service File written successfully\\n')\r\n            }\r\n          }\r\n        )\r\n      } else {\r\n        console.log('Service File not written\\n')\r\n      }\r\n\r\n      if (\r\n        fs.existsSync(\r\n          srcDirName +\r\n            '/node_modules/@pullup.tech/cms/samples/repository-sample.txt'\r\n        )\r\n      ) {\r\n        let controller = fs.readFileSync(\r\n          srcDirName +\r\n            '/node_modules/@pullup.tech/cms/samples/repository-sample.txt'\r\n        )\r\n        const controllerCode = Buffer.from(controller)\r\n          .toString()\r\n          .replace(/{{MODULE_NAME}}/g, moduleFile)\r\n          .replace(/{{MODEL_NAME}}/g, modelName)\r\n        fs.writeFile(\r\n          `${srcDirName}/modules/${moduleFile}/${moduleFile}-repository.ts`,\r\n          controllerCode,\r\n          (err) => {\r\n            if (err) console.error(err)\r\n            else {\r\n              console.log('Repository File written successfully\\n')\r\n            }\r\n          }\r\n        )\r\n      } else {\r\n        console.log('Repository File not written\\n')\r\n      }\r\n\r\n      if (\r\n        fs.existsSync(\r\n          srcDirName +\r\n            '/node_modules/@pullup.tech/cms/samples/module-sample.txt'\r\n        )\r\n      ) {\r\n        let controller = fs.readFileSync(\r\n          srcDirName +\r\n            '/node_modules/@pullup.tech/cms/samples/module-sample.txt'\r\n        )\r\n        const controllerCode = Buffer.from(controller)\r\n          .toString()\r\n          .replace(/{{MODULE_NAME}}/g, moduleFile)\r\n          .replace(/{{MODEL_NAME}}/g, modelName)\r\n        fs.writeFile(\r\n          `${srcDirName}/modules/${moduleFile}/${moduleFile}-module.ts`,\r\n          controllerCode,\r\n          (err) => {\r\n            if (err) console.error(err)\r\n            else {\r\n              console.log('Module File written successfully\\n')\r\n            }\r\n          }\r\n        )\r\n      } else {\r\n        console.log('Module File not written\\n')\r\n      }\r\n\r\n      if (\r\n        fs.existsSync(\r\n          srcDirName +\r\n            '/node_modules/@pullup.tech/cms/samples/interfaces-sample.txt'\r\n        )\r\n      ) {\r\n        let controller = fs.readFileSync(\r\n          srcDirName +\r\n            '/node_modules/@pullup.tech/cms/samples/interfaces-sample.txt'\r\n        )\r\n        const controllerCode = Buffer.from(controller)\r\n          .toString()\r\n          .replace(/{{MODULE_NAME}}/g, moduleFile)\r\n          .replace(/{{MODEL_NAME}}/g, modelName)\r\n        fs.writeFile(\r\n          `${srcDirName}/modules/${moduleFile}/${moduleFile}-interfaces.ts`,\r\n          controllerCode,\r\n          (err) => {\r\n            if (err) console.error(err)\r\n            else {\r\n              console.log('Interfaces File written successfully\\n')\r\n            }\r\n          }\r\n        )\r\n      } else {\r\n        console.log('Interfaces File not written\\n')\r\n      }\r\n    })\r\n  }\r\n\r\n  removeModule(srcDirName: string, name: string) {\r\n    if (fs.existsSync(`${srcDirName}/modules/${name}`)) {\r\n      fs.rmdir(\r\n        `${srcDirName}/modules/${name}`,\r\n        { recursive: true },\r\n        (error) => {\r\n          if (error) {\r\n            console.error(error)\r\n          } else {\r\n            console.log('Folder Deleted!')\r\n          }\r\n        }\r\n      )\r\n    }\r\n  }\r\n}\r\n","import { PrismaClient } from '@prisma/client'\r\nimport { NextFunction, Response } from 'express'\r\nimport jwt, { JwtPayload } from 'jsonwebtoken'\r\nimport AuthRepository from '../../../modules/auth/auth-repository'\r\nimport { Config } from '../../config/env'\r\nimport { AuthenticationError, ForbiddenError } from '../../helpers/error'\r\nimport { onError } from '../../helpers/response'\r\n\r\nconst env = Config.instance\r\nconst userRepository: AuthRepository = new AuthRepository(new PrismaClient())\r\n\r\nexport interface Token extends JwtPayload {\r\n  payload: string\r\n}\r\n\r\nexport async function verifyToken(\r\n  request: any,\r\n  response: Response,\r\n  next: NextFunction\r\n) {\r\n  try {\r\n    const token = request.headers.authorization?.replace('Bearer ', '')\r\n    const decodedToken: any = jwt.verify(token, `${env.config.jwtSecret}`)\r\n    const dbUser = await userRepository.findByEmail(`${decodedToken.payload}`)\r\n\r\n    if (!dbUser) throw new AuthenticationError('Usuário não encontrado')\r\n\r\n    if (!dbUser.status || dbUser.status !== 'approved')\r\n      throw new ForbiddenError('Usuário não autorizado')\r\n\r\n    request.user = dbUser\r\n\r\n    next()\r\n  } catch (error: any) {\r\n    return onError(response, error)\r\n  }\r\n}\r\n","// @ts-expect-error\r\nimport { PrismaClient, user } from '@prisma/client'\r\n//import { UserRegisterPayload } from './auth-interfaces'\r\n\r\nexport default class AuthRepository {\r\n  constructor(private readonly client: PrismaClient) {}\r\n\r\n  public async findByEmail(email: string): Promise<user | null> {\r\n    const user = await this.client.user.findFirst({\r\n      where: { email },\r\n      include:{\r\n        role: true, \r\n      }\r\n    })\r\n    if(user){\r\n      console.log('user',user)\r\n    }\r\n    return user\r\n  }\r\n\r\n  public async findByConfirmationCode(\r\n    confirmationCode: string\r\n  ): Promise<user | null> {\r\n    const user = await this.client.user.findFirst({\r\n      // @ts-ignore\r\n      where: { confirmationCode },\r\n    })\r\n    return user\r\n  }\r\n\r\n  public async saveConfirmationCode(\r\n    id: number,\r\n    confirmationCode: string | null\r\n  ): Promise<user> {\r\n    const user = await this.client.user.update({\r\n      where: { id },\r\n      // @ts-ignore\r\n      data: { confirmationCode },\r\n    })\r\n\r\n    return user\r\n  }\r\n\r\n  public async updatePassword(id: number, password: string): Promise<user> {\r\n    const user = await this.client.user.update({\r\n      where: { id },\r\n      data: { password },\r\n    })\r\n\r\n    return user\r\n  }\r\n\r\n  public async store(data: any): Promise<user> {\r\n   \r\n    const user = await this.client.user.create({\r\n      data,\r\n    })\r\n\r\n    return user\r\n  }\r\n}\r\n","import fs from 'fs'\r\nexport interface BaseConfig {\r\n  apiContext: string\r\n  apiVersion: string\r\n  serverPort: number\r\n  smtpHost: string\r\n  smtpPort: number\r\n  smtpSecure: boolean\r\n  smtpPass: string\r\n  smtpUser: string\r\n  mailFrom: string\r\n  frontURL: string\r\n  jwtSecret: string\r\n}\r\nexport class Config {\r\n  private readonly _config: BaseConfig\r\n  private static _instance: Config\r\n\r\n  public static get instance() {\r\n    if (!Config._instance) {\r\n      Config._instance = new Config()\r\n    }\r\n\r\n    return Config._instance\r\n  }\r\n\r\n  public get config() {\r\n    return this._config\r\n  }\r\n\r\n  private constructor() {\r\n    this._config = this.readConfigFile()\r\n  }\r\n\r\n  private readConfigFile() {\r\n    let config = fs.readFileSync('pullup.config.json')\r\n\r\n    return JSON.parse(config.toString())\r\n  }\r\n}\r\n","export interface ResponseError extends Error {\r\n  get status(): number\r\n}\r\n\r\nexport class NotFoundError extends Error implements ResponseError {\r\n  private _status: number\r\n\r\n  constructor(message: string) {\r\n    super(message)\r\n    this._status = 404\r\n  }\r\n\r\n  public get status() {\r\n    return this._status\r\n  }\r\n}\r\n\r\nexport class BadRequestError extends Error implements ResponseError {\r\n  private readonly _status: number\r\n  constructor(message: string) {\r\n    super(message)\r\n    this._status = 400\r\n  }\r\n\r\n  public get status() {\r\n    return this._status\r\n  }\r\n}\r\n\r\nexport class AuthenticationError extends Error implements ResponseError {\r\n  private readonly _status: number\r\n  constructor(message: string) {\r\n    super(message)\r\n    this._status = 401\r\n  }\r\n\r\n  public get status() {\r\n    return this._status\r\n  }\r\n}\r\n\r\nexport class UnprocessableEntityError extends Error implements ResponseError {\r\n  private readonly _status: number\r\n  constructor(message: string) {\r\n    super(message)\r\n    this._status = 422\r\n  }\r\n\r\n  public get status() {\r\n    return this._status\r\n  }\r\n}\r\nexport class ForbiddenError extends Error implements ResponseError {\r\n  private readonly _status: number\r\n  constructor(message: string) {\r\n    super(message)\r\n    this._status = 403\r\n  }\r\n\r\n  public get status() {\r\n    return this._status\r\n  }\r\n}\r\n","import { Response } from 'express'\r\nimport { ErrorDTO, SuccessDTO } from '../interfaces/response-interface'\r\n\r\nimport { ResponseError } from './error'\r\n\r\nexport function onError(response: Response, error: ResponseError) {\r\n  const errorResponse: ErrorDTO = { response, error }\r\n  console.error(`${errorResponse.error.message}`)\r\n  response\r\n    .status(errorResponse.error.status || 500)\r\n    .json({ success: false, message: errorResponse.error.message })\r\n}\r\n\r\nexport function onSuccess(\r\n  response: Response,\r\n  statusCode: number,\r\n  data: Object\r\n) {\r\n  const successResponse: SuccessDTO = { response, statusCode, data }\r\n  successResponse.response\r\n    .status(successResponse.statusCode)\r\n    .json({ success: true, ...successResponse.data })\r\n}\r\n","import { Module } from '../module-interface'\r\nimport AuthRouter from './auth-router'\r\nimport { PrismaClient } from '@prisma/client'\r\nexport default class AuthModule implements Module {\r\n  public readonly moduleName: string\r\n  public readonly router: AuthRouter\r\n  public isPublic: boolean = true\r\n\r\n  constructor(moduleName: string) {\r\n    this.moduleName = moduleName\r\n\r\n    this.router = new AuthRouter(new PrismaClient())\r\n    this.loadRoutes()\r\n  }\r\n\r\n  private loadRoutes() {\r\n    this.router.login().register().forgotPassword().updatePassword().me()\r\n  }\r\n}\r\n","import { PrismaClient } from '@prisma/client'\r\nimport { Request, Response, Router } from 'express'\r\nimport { verifyToken } from '../../core/middlewares/auth/verifyToken'\r\nimport { AppRouter } from '../module-interface'\r\nimport AuthController from './auth-controller'\r\nexport default class AuthRouter implements AppRouter {\r\n  public readonly router: Router = Router()\r\n  private readonly controller: AuthController\r\n\r\n  constructor(public prismaClient: PrismaClient) {\r\n    this.controller = new AuthController(prismaClient)\r\n  }\r\n  public login() {\r\n    this.router.post('/login', (request: Request, response: Response) => {\r\n      this.controller.login(request, response)\r\n    })\r\n    return this\r\n  }\r\n\r\n  public register() {\r\n    this.router.post('/register', (request: Request, response: Response) => {\r\n      this.controller.register(request, response)\r\n    })\r\n    return this\r\n  }\r\n\r\n  public me() {\r\n    this.router.get(\r\n      '/me',\r\n      verifyToken,\r\n      (request: Request, response: Response) => {\r\n        this.controller.me(request, response)\r\n      }\r\n    )\r\n    return this\r\n  }\r\n\r\n  public forgotPassword() {\r\n    this.router.post(\r\n      '/forgot-password',\r\n      (request: Request, response: Response) => {\r\n        this.controller.forgotPassword(request, response)\r\n      }\r\n    )\r\n    return this\r\n  }\r\n\r\n  public updatePassword() {\r\n    this.router.patch(\r\n      '/update-password',\r\n      (request: Request, response: Response) => {\r\n        this.controller.updatePassword(request, response)\r\n      }\r\n    )\r\n    return this\r\n  }\r\n}\r\n","import { PrismaClient } from '@prisma/client'\r\nimport { Request, Response } from 'express'\r\nimport { onError, onSuccess } from '../../core/helpers/response'\r\nimport AuthService from './auth-service'\r\n\r\nexport default class AuthController {\r\n  private readonly service: AuthService\r\n\r\n  constructor(public prismaClient: PrismaClient) {\r\n    this.service = new AuthService(prismaClient)\r\n  }\r\n\r\n  public async login(request: Request, response: Response) {\r\n    try {\r\n      const loginResponse = await this.service.login(request.body)\r\n\r\n      return onSuccess(response, 200, loginResponse)\r\n    } catch (error: any) {\r\n      return onError(response, error)\r\n    }\r\n  }\r\n\r\n  public async register(request: Request, response: Response) {\r\n    try {\r\n      const user = await this.service.register(request.body)\r\n\r\n      return onSuccess(response, 201, user)\r\n    } catch (error: any) {\r\n      return onError(response, error)\r\n    }\r\n  }\r\n\r\n  public async me(request: any, response: Response) {\r\n    try {\r\n      const user = await this.service.me(request.user)\r\n\r\n      return onSuccess(response, 201, user)\r\n    } catch (error: any) {\r\n      return onError(response, error)\r\n    }\r\n  }\r\n\r\n  public async forgotPassword(request: Request, response: Response) {\r\n    try {\r\n      const message = await this.service.forgotPassword(request.body)\r\n\r\n      return onSuccess(response, 200, { message })\r\n    } catch (error: any) {\r\n      return onError(response, error)\r\n    }\r\n  }\r\n\r\n  public async updatePassword(request: Request, response: Response) {\r\n    try {\r\n      const message = await this.service.updatePassword(request.body)\r\n\r\n      return onSuccess(response, 200, { message })\r\n    } catch (error: any) {\r\n      return onError(response, error)\r\n    }\r\n  }\r\n}\r\n","// @ts-expect-error\r\nimport { PrismaClient, user } from '@prisma/client'\r\nimport AuthRepository from './auth-repository'\r\nimport bcrypt from 'bcrypt'\r\nimport * as yup from 'yup'\r\nimport jwt from 'jsonwebtoken'\r\nimport fs from 'fs'\r\nimport path from 'path'\r\nimport { sendEmail } from '../../core/providers/nodemailer'\r\nimport {\r\n  AuthenticationError,\r\n  BadRequestError,\r\n  NotFoundError,\r\n  UnprocessableEntityError,\r\n} from '../../core/helpers/error'\r\nimport {\r\n  UserLoginPayload,\r\n  UserRegisterPayload,\r\n  UserForgotPasswordPayloadDTO,\r\n} from './auth-interfaces'\r\nimport { Config } from '../../core/config/env'\r\n\r\nconst env = Config.instance\r\nexport default class AuthService {\r\n  private readonly authRepository: AuthRepository\r\n\r\n  constructor(public prismaClient: PrismaClient) {\r\n    this.authRepository = new AuthRepository(prismaClient)\r\n  }\r\n\r\n  private _generateAuthToken(email: string, expiresIn: string = '24h') {\r\n    return jwt.sign({ payload: email }, env.config.jwtSecret, { expiresIn })\r\n  }\r\n\r\n  async login(payload: UserLoginPayload) {\r\n    const userSchema = yup.object({\r\n      email: yup.string().email().required(),\r\n      password: yup.string().min(8).required(),\r\n    })\r\n    const validatedData = await userSchema.validate(payload)\r\n\r\n    const user = await this.authRepository.findByEmail(validatedData.email)\r\n\r\n    if (!user) throw new AuthenticationError('Usuário inválido!')\r\n\r\n    const isPasswordValid = await bcrypt.compare(\r\n      validatedData.password,\r\n      user.password\r\n    )\r\n\r\n    if (!isPasswordValid) throw new AuthenticationError('Usuário inválido!')\r\n\r\n    const { password, ...userResponse } = user\r\n\r\n    return {\r\n      token: this._generateAuthToken(user.email),\r\n      user: userResponse,\r\n    }\r\n  }\r\n\r\n  async register(payload: UserRegisterPayload) {\r\n    console.log('payload', payload)\r\n    const userSchema = yup.object({\r\n      name: yup.string().min(3).required(),\r\n      email: yup.string().email().required(),\r\n      password: yup.string().min(8).required(),\r\n      roleId: yup.number().required(),\r\n    })\r\n    const validatedData = await userSchema.validate(payload)\r\n\r\n    const isRegistered = await this.authRepository.findByEmail(\r\n      validatedData.email\r\n    )\r\n\r\n    if (isRegistered) throw new AuthenticationError('Usuário inválido!')\r\n\r\n    const salt = await bcrypt.genSalt()\r\n    const hashPassword = await bcrypt.hash(validatedData.password, salt)\r\n\r\n    let data = payload\r\n    data = {\r\n      ...data,\r\n      password: hashPassword\r\n    }\r\n\r\n    console.log('{...data, ...payload}', data)\r\n    const { password, ...userResponse } = await this.authRepository.store(data)\r\n    return { user: userResponse }\r\n  }\r\n\r\n  async forgotPassword(email: string) {\r\n    const userSchema = yup.object({\r\n      email: yup.string().email().required(),\r\n    })\r\n    const validatedData = await userSchema.validate(email)\r\n\r\n    const user = await this.authRepository.findByEmail(validatedData.email)\r\n\r\n    if (!user) throw new AuthenticationError('Usuário inválido!')\r\n\r\n    const template = fs.readFileSync(\r\n      path.resolve(__dirname, '../../templates/forgot-password.html')\r\n    )\r\n\r\n    const token = this._generateAuthToken(user.email, '1h')\r\n\r\n    const success = this.authRepository.saveConfirmationCode(user.id, token)\r\n\r\n    if (!success)\r\n      throw new UnprocessableEntityError('Erro ao processar solicitação')\r\n\r\n    let emailBody = template\r\n      .toString()\r\n      .replace('#front-url#', env.config.frontURL)\r\n    emailBody = emailBody.replace('#confirmation-code#', `${token}`)\r\n\r\n    const message = await sendEmail(\r\n      user.email,\r\n      'Esqueci Minha Senha',\r\n      emailBody\r\n    )\r\n\r\n    return message\r\n  }\r\n\r\n  async me(requestUser: user) {\r\n    const dbUser = await this.authRepository.findByEmail(requestUser.email)\r\n\r\n    if (!dbUser) throw new NotFoundError('Usuário não encontrado!')\r\n\r\n    // @ts-ignore\r\n    const { password, confirmationCode, ...userResponse } = dbUser\r\n    return { user: userResponse }\r\n  }\r\n\r\n  async updatePassword(payload: UserForgotPasswordPayloadDTO) {\r\n    const userSchema = yup.object({\r\n      newPassword: yup.string().min(8).required(),\r\n      newPasswordConfirmation: yup.string().min(8).required(),\r\n      confirmationCode: yup.string().required(),\r\n    })\r\n\r\n    const validatedData = await userSchema.validate(payload)\r\n\r\n    if (validatedData.newPassword !== validatedData.newPasswordConfirmation)\r\n      throw new BadRequestError('Senha inválida!')\r\n\r\n    const decodedToken = jwt.verify(\r\n      validatedData.confirmationCode,\r\n      env.config.jwtSecret\r\n    )\r\n    const user = await this.authRepository.findByConfirmationCode(\r\n      validatedData.confirmationCode\r\n    )\r\n\r\n    if (!decodedToken || !user) throw new BadRequestError('Código inválido!')\r\n\r\n    await this.authRepository.saveConfirmationCode(user.id, null)\r\n\r\n    const salt = await bcrypt.genSalt()\r\n    const hashPassword = await bcrypt.hash(validatedData.newPassword, salt)\r\n\r\n    const isPassSaved = await this.authRepository.updatePassword(\r\n      user.id,\r\n      hashPassword\r\n    )\r\n\r\n    if (!isPassSaved) throw new UnprocessableEntityError('Senha Inválida!')\r\n\r\n    return `Senha atualizada com sucesso!`\r\n  }\r\n}\r\n","'use strict'\r\nimport nodemailer from 'nodemailer'\r\nimport { Config } from '../config/env'\r\n\r\nconst env = Config.instance\r\n\r\nconst transport = nodemailer.createTransport({\r\n  host: env.config.smtpHost,\r\n  port: env.config.smtpPort,\r\n  secure: env.config.smtpSecure,\r\n  auth: {\r\n    user: env.config.smtpUser,\r\n    pass: env.config.smtpPass,\r\n  },\r\n  tls: {\r\n    ciphers: 'SSLv3',\r\n  },\r\n})\r\n\r\nexport async function sendEmail(\r\n  emailTo: string,\r\n  subject: string,\r\n  html: string\r\n) {\r\n  try {\r\n    const info = await transport.sendMail({\r\n      from: env.config.mailFrom,\r\n      to: emailTo,\r\n      subject,\r\n      html,\r\n      //   attachments: [\r\n      //     {\r\n      //       filename: 'report.pdf',\r\n      //       path: options.pdf,\r\n      //       contentType: 'application/pdf',\r\n      //       encoding: 'base64',\r\n      //     },\r\n      //   ],\r\n    })\r\n    console.log(info)\r\n    return `Mensagem enviada para: ${info.accepted}`\r\n  } catch (error) {\r\n    console.error(error)\r\n    return `Não foi possível enviar a mensagem`\r\n  }\r\n}\r\n"],"names":[],"version":3,"file":"index.es.js.map"}